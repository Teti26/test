# Психологические игры — браузерное приложение для когнитивных тренировок

Коротко: веб‑приложение с набором тренажёров внимания и памяти (⚡ Реакция, Струп, N‑back, Память/Сетка, Саймон, Go/No‑Go, Дыхание). Фронтенд на HTML/JS/CSS. Есть минимальный Node.js‑сервер для статики и API результатов (SQLite). Подходит для локальной работы и простого деплоя.

---

## Возможности

* Игры: Реакция, Струп, 2‑back, Память/Сетка, Саймон, Go/No‑Go, Дыхание.
* Локальное сохранение прогресса (localStorage).
* (Опционально) REST‑API для результатов: POST/GET `/api/results`.
* Панель **Dashboard**: быстрый просмотр последних результатов и агрегатов.

---

## Быстрый старт

### Вариант A — только фронтенд (без API)

> Подходит для теста UI/логики игр.

```bash
# клон
git clone https://github.com/<user>/test.git
cd test

# любой статический сервер
npx serve .            # или npx http-server .
# откройте http://localhost:3000 (порт может отличаться)
```

### Вариант B — с Node.js API (рекомендуется)

**Требования:** Node.js ≥ 18, npm.

```bash
git clone https://github.com/<user>/test.git
cd test
npm install

# локальный запуск
npm run dev            # с перезапуском (nodemon)
# или
npm start              # node server.js
```

По умолчанию база `data.db` будет создана рядом с сервером. Путь можно задать через переменную окружения:

```bash
# .env или переменные окружения
DB_PATH=./data/data.db
PORT=3000
```

> **Внимание:** не коммитьте `*.db` и `node_modules/` в репозиторий (см. .gitignore ниже).

---

## Структура проекта

```
.
├─ index.html          # главная страница/навигация по играм
├─ dashboard.html      # сводка результатов
├─ login.html          # заглушка под авторизацию (можно скрыть до внедрения auth)
├─ intake.html         # формы сбора данных (не хранить ПДн в localStorage)
├─ styles.css
├─ index.js            # входной модуль фронтенда
├─ js/                 # модули игр и инфраструктуры
│  ├─ reaction.js
│  ├─ stroop.js
│  ├─ nback.js
│  ├─ memory.js
│  ├─ simon.js
│  ├─ gonogo.js
│  └─ store.js         # единый слой сохранения: localStorage + POST /api/results
├─ server.js           # простой Express‑сервер + API результатов
├─ package.json
└─ .gitignore
```

---

## Сценарий сохранения результата (контракт игры)

Каждый модуль игры вызывает общий метод `saveResult()` с унифицированным объектом:

```js
saveResult({
  game: "stroop",           // идентификатор игры
  score: 87.5,               // агрегированный балл (проценты, очки и т.п.)
  details: {                 // произвольная структура с метриками
    accuracy: 0.875,
    meanRT: 523,
    trials: 64
  },
  ts: Date.now()             // выставляется автоматически
});
```

Под капотом:

* результат кладётся в `localStorage` (кольцевой буфер, последние N=200 записей);
* выполняется `fetch('/api/results', { method: 'POST', ... })` — «мягкая» попытка отправить данные на сервер (без блокировки UI).

### REST‑API (если запущен сервер)

* `POST /api/results`

  * body: `{ user?: string|null, game: string, score?: number, details?: any, ts?: number }`
  * 201 `{ ok: true }`
* `GET /api/results?game=stroop&limit=50`

  * ответ: массив результатов, отсортированных по времени (DESC)
* `GET /healthz` — health‑check.

---

## Скрипты npm

```json
{
  "scripts": {
    "dev": "nodemon server.js",
    "start": "node server.js",
    "lint": "eslint ."
  }
}
```

> Если используете чисто статическую выдачу — скрипты не обязательны, но рекомендованы для удобства.

---

## .gitignore (рекомендуется)

```gitignore
# зависимости
node_modules/

# переменные окружения
.env

# локальные базы/кэш
*.db

# сборки/артефакты
.dist/
dist/
.vercel/
```

> Удалите уже закоммиченные `node_modules/` и `*.db` из истории (`git rm -r --cached ...`).

---

## Деплой

### Вариант A — статический фронт (Vercel/Netlify/GitHub Pages)

* Хостим только HTML/CSS/JS.
* API недоступно → результаты сохраняются локально.

### Вариант B — полный сервер

* **Render / Railway / Fly.io / VPS**: укажите старт‑команду `node server.js`, переменные `PORT`, `DB_PATH`.
* **База**: SQLite подходит для одиночного инстанса. Для масштабирования — Postgres (Neon/Render) + Prisma.

> Для деплоя на Vercel вместе с API перенесите эндпоинты в функции `/api/*` (Serverless). Текущий `server.js` можно разбить на статическую выдачу + `api/results.js`.

---

## Безопасность и ПДн

* Не храните персональные данные в `localStorage`.
* Отправляйте чувствительные поля только по HTTPS, с явным согласием и минимизацией данных.
* Проверьте CORS/Helmet/Compression на сервере; не коммитьте секреты.

---

## План развития (roadmap)

* Авторизация (Supabase/Clerk/NextAuth) и личный кабинет.
* Перенос результатов в облачную БД (Postgres + Prisma), графики в Dashboard.
* Экспорт в CSV/JSON, фильтры и сравнение прогресса по периодам.
* PWA (офлайн‑режим), hotkeys, доступность (a11y), i18n.
* Автотесты на механику игр и стабильность метрик.

---

## Лицензия

MIT (можно заменить на иную по необходимости).

---

## Вклад

PR и issue приветствуются. Предлагайте улучшения интерфейса игр, метрик и структуры кода.
